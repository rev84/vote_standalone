// Generated by CoffeeScript 1.12.7
var changePoint, onFailure, onSuccess, vote;

$().ready(function() {
  $('.slider, .point').on('input', function() {
    return changePoint($(this).attr('subject_id'), $(this).val());
  });
  return $('.vote').on('click', vote);
});

changePoint = function(subjectId, point) {
  $('.point[subject_id="' + subjectId + '"]').val(point);
  return $('.slider[subject_id="' + subjectId + '"]').val(point);
};

vote = function() {
  var comment, params, point, ref, ref1, subjectId;
  subjectId = $(this).attr('subject_id');
  point = $('.point[subject_id="' + subjectId + '"]').val();
  if (!((window.POINT_MIN <= (ref = Number(point)) && ref <= POINT_MAX))) {
    return window.alert('点数は' + window.POINT_MIN + '～' + window.POINT_MAX + '点で入力してください。');
  }
  comment = $('.comment[subject_id="' + subjectId + '"]').val();
  comment = comment === '' ? null : comment;
  if (comment !== null && !((window.COMMENT_MIN <= (ref1 = comment.length) && ref1 <= COMMENT_MAX))) {
    return window.alert('コメントは' + window.COMMENT_MIN + '～' + window.COMMENT_MAX + '文字で入力してください。');
  }
  params = {
    SubjectId: subjectId,
    Point: point,
    Comment: comment
  };
  return Utl.request('subjects/vote', params, onSuccess, onFailure);
};

onSuccess = function() {
  return window.alert('投票に成功しました。');
};

onFailure = function() {
  return window.alert('投票に失敗しました。');
};
